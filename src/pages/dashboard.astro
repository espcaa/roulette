---
import Layout from '../layouts/Layout.astro';
import Background from '../components/Background.astro';


import { requireUser } from '../lib/auth.js';

let userData;

export const prerender = false;

try {
  userData = await requireUser(Astro.request.headers);

} catch {
  return new Response(null, {
    status: 302,
    headers: { Location: '/' },
  });
}

var user = userData.fields;

---

<Layout>
<main>
<Background>
</Background>
<div class="foreground">
<p>Welcome, {user.name}!</p>

<img src={user.avatar}></img>

</div>

</main>
</Layout>


<style>
	main {
		width: 100%;
		height: 100%;
		text-align: center;

		overflow: hidden;
	}

	main > div {
		position: absolute;
		width: 100%;
		height: 100%;
	}
  </style>
